<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><title>Bytes #48 - the cutthroat Pâtisserie world</title><link rel="canonical" href="https://bytes.dev/archives/48"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="description" content="This issue, we&#x27;ve got some Angular Ivy, Recoil, and cursed Elon Musk SNL sketches"/><meta property="og:url" content="https://bytes.dev/archives/48"/><meta property="og:title" content="Bytes #48 - the cutthroat Pâtisserie world"/><meta property="og:type" content="website"/><meta property="og:image" content="https://bytes.devhttps://bytes.dev/images/content/ivy.png"/><meta property="og:site_name" content="Bytes by ui.dev"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:description" content="This issue, we&#x27;ve got some Angular Ivy, Recoil, and cursed Elon Musk SNL sketches"/><meta property="twitter:url" content="https://bytes.dev/"/><meta property="twitter:title" content="Bytes #48 - the cutthroat Pâtisserie world"/><meta property="twitter:description" content="This issue, we&#x27;ve got some Angular Ivy, Recoil, and cursed Elon Musk SNL sketches"/><meta property="twitter:image" content="https://bytes.devhttps://bytes.dev/images/content/ivy.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="uidotdev"/><meta name="next-head-count" content="26"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=2712034659094542&amp;ev=PageView&amp;noscript=1"/></noscript><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/4cfe03ce098bd055.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4cfe03ce098bd055.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-45c1d38871d29bef.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-2eac51a0f0ef9b48.js" defer=""></script><script src="/_next/static/chunks/pages/_app-19dca011c0f14f43.js" defer=""></script><script src="/_next/static/chunks/17007de1-87d7b770c56a584a.js" defer=""></script><script src="/_next/static/chunks/318-62d05fcf8d1400db.js" defer=""></script><script src="/_next/static/chunks/pages/archives/%5Bslug%5D-c56c612fe73a68c8.js" defer=""></script><script src="/_next/static/dY9LIRQQ58VhV_MFEhYS7/_buildManifest.js" defer=""></script><script src="/_next/static/dY9LIRQQ58VhV_MFEhYS7/_ssgManifest.js" defer=""></script><style id="__jsx-undefined">
    .email-wrapper {
      color: #231F20;
      background-color: #FFF;
      font-size: 16px;
      font-family: Outfit, sans-serif;
    }

    p {
      font-family: Outfit, sans-serif;
      line-height: 1.5;
      font-size: 17px;
    }

    h3, * + p:not([class]) {
      padding-left: 24px;
      padding-right: 24px;
    }

    a:not([class]) {
      color: #12b5e5;
      text-decoration: underline;
      font-weight: 600;
    }

    h2 {
      margin-top: 10px;
    }

    h3 {
      font-size: 24px;
      margin-bottom: 0;
      padding-left: 24px;
      padding-right: 24px;
    }
    

    h4 {
      font-size: 19px;
      margin-bottom: 0;
      padding-left: 24px;
      padding-right: 24px;
    }
    
    img {
      max-width: 100%;
    }

    strong {
      font-weight: 600;
    }

    pre {
      background-color: #f9f9f9;
      border: 1px solid #f9f9f9;
      color: #231F20;
      padding: 24px;
      border-radius: 8px;
    }

    table {
      border-collapse: collapse;
    }

    td {
      word-break: normal; border-collapse : collapse !important;
    }

    hr {
      border: 0;
      border-color: #f5f5f5;
      border-bottom: 5px solid;
      margin-top: 100px;
      margin-bottom: 100px;
    }

    .section-presenter p {
      font-size: 16px;
      margin-top: 5px;
    }

    mark {
      background-color: #F9F4DA;
      color: #231F20;
      padding-left: 2px;
      padding-right: 2px;
      border-radius: 2px;
    }

    .bg-alt {
      background-color: #f5f5f5;
    }

    @media (prefers-color-scheme: dark) {
      .email-wrapper {
        color: #F9F4DA !important;
        background-color: #0F0D0E !important;
      }

      hr {
        border-color: #262422 !important;
      }

      mark {
        background-color: #231F20 !important;
        color: #F9F4DA !important;
      }

      pre {
        background-color: #231F20 !important;
        border: 1px solid #231F20 !important;
        color: #F9F4DA !important;
      }

      .bg-alt { 
        background-color: #231F20 !important;
      }

      .unsubscribe-link {
        color: #8d8a7f !important;
      }

      .token.punctuation { 
        color: #f9f4da !important;
      }
    }

    @media screen and (min-width: 600px)  {
      .mobile-break { display: none; }
    }

    code[class*="language-"],
    pre[class*="language-"] {
      font-family: "Fira Mono", "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
      font-size: 14px;
      line-height: 1.5;
      direction: ltr;
      text-align: left;
      white-space: pre;
      word-spacing: normal;
      word-break: normal;
      -moz-tab-size: 2;
      -o-tab-size: 2;
      tab-size: 2;
      -webkit-hyphens: none;
      -moz-hyphens: none;
      -ms-hyphens: none;
      hyphens: none;
      color: #c0c5ce;
    }
    pre[class*=language-] {
      overflow: auto;
    }
    pre[class*="language-"]::-moz-selection,
    pre[class*="language-"] ::-moz-selection,
    code[class*="language-"]::-moz-selection,
    code[class*="language-"] ::-moz-selection {
      text-shadow: none;
      background: #a7adba;
    }
    pre[class*="language-"]::selection,
    pre[class*="language-"] ::selection,
    code[class*="language-"]::selection,
    code[class*="language-"] ::selection {
      text-shadow: none;
      background: #a7adba;
    }
    :not(pre) > code[class*="language-"] {
      padding: 3px;
      border-radius: 0.3em;
      white-space: normal;
    }
    .language-text {
      background: #36424D !important;
      padding: 3px 8px !important;
      color: #e5e5e5 !important;
    }
    code,
    code * {
      font-size: 14px;
    }
    code:not(pre) {
      font-size: 17px;
    }
    .token.comment {
      color: rgb(167, 167, 167);
    }
    .token.punctuation { 
      color: #231F20;
    }
    .token.deleted {
      color: #ed203d;
    }
    .token.inserted,
    .token.attr-name {
      color: #0ba95b;
    }
    .token.string,
    .token.url {
      color: #f99157;
    }
    .token.attr-value,
    .token.number {
      color: #fcba28;
    }
    .token.boolean,
    .token.keyword,
    .token.function {
      color: #9d7dce;
    }
    .token.keyword,
    .token.tag,
    .token.parameter,
    .token.method,
    .token.property-access {
      color: #f38ba3;
    }
    .token.changed,
    .token.property,
    .token.namespace,
    .token.operator,
    .token.selector,
    .token.doctype,
    .token.class-name,
    .token.builtin,
    .token.char,
    .token.constant,
    .token.interpolation {
      color: #12b5e5;
    }
</style><style data-styled="" data-styled-version="5.3.5"></style><style data-href="https://fonts.googleapis.com/css2?family=Fira+Mono&family=Outfit:wght@400;500;700;900&family=Paytone+One">@font-face{font-family:'Fira Mono';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/firamono/v14/N0bX2SlFPv1weGeLZDtQIg.woff) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYyz_MVcBeNP4NjuGObqx1XmO1I4TC1C4I.woff) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYyz_MVcBeNP4NjuGObqx1XmO1I4QK1C4I.woff) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYyz_MVcBeNP4NjuGObqx1XmO1I4deyC4I.woff) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:900;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYyz_MVcBeNP4NjuGObqx1XmO1I4ZmyC4I.woff) format('woff')}@font-face{font-family:'Paytone One';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/paytoneone/v23/0nksC9P7MfYHj2oFtYm2CiTp.woff) format('woff')}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/firamono/v14/N0bX2SlFPv1weGeLZDtgK_7Ss9XZYalI.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/firamono/v14/N0bX2SlFPv1weGeLZDtgIv7Ss9XZYalI.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/firamono/v14/N0bX2SlFPv1weGeLZDtgKv7Ss9XZYalI.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/firamono/v14/N0bX2SlFPv1weGeLZDtgJf7Ss9XZYalI.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/firamono/v14/N0bX2SlFPv1weGeLZDtgKP7Ss9XZYalI.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/firamono/v14/N0bX2SlFPv1weGeLZDtgJv7Ss9XZYQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:900;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:900;src:url(https://fonts.gstatic.com/s/outfit/v11/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Paytone One';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/paytoneone/v23/0nksC9P7MfYHj2oFtYm2ChTigPvfiwq-FQc.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Paytone One';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/paytoneone/v23/0nksC9P7MfYHj2oFtYm2ChTjgPvfiwq-FQc.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Paytone One';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/paytoneone/v23/0nksC9P7MfYHj2oFtYm2ChTtgPvfiwq-.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div><div class="text-white"><div class="bg-brand-coal"><nav class="flex justify-between items-center mb-10 p-8 container mx-auto gap-12"><a class="block relative" href="/"><img width="48" src="/images/bytes-icon.png" alt="Bytes by ui.dev"/></a><div class="flex gap-8"><a class="sm:text-xl text-biege hover:text-yellow underline" href="/advertise">advertise</a><a class="sm:text-xl text-biege hover:text-yellow underline" href="/archives">archives</a></div></nav><div class="mx-auto md:pt-14 md:pb-8 text-center max-w-[75ch]"><h1 class="font-black text-3xl lg:text-6xl uppercase"> the cutthroat Pâtisserie world</h1><div class="text-sm sm:text-lg font-normal font-mono mt-6"><span class="mr-6 font-bold">Issue #<!-- -->48<!-- -->.</span><span class="mr-6 font-bold">May 17, 2021<!-- -->.</span><span class="font-bold">2 Minute read.</span></div></div></div><div class="p-8 pt-0 relative xl:grid xl:grid-cols-[1fr_auto_1fr] gap-10"><div class="hidden xl:block"></div><div style="line-height:32.36px;font-size:20px" class="jsx-undefined post max-w-[600px] mx-auto"><div class="jsx-undefined"><html><head></head><body><div style="max-width:600px;padding-top:80px"><div style="text-align:center"><img width="600" style="padding-bottom:40px;max-width:100%" src="https://bytes.dev/images/bytes-banner-rounded.png" alt="Bytes"></div><h2>Angular 12 goes all-in on Ivy</h2>
<p><img src="https://bytes.dev/images/content/ivy.png" alt="Ivy">
</p><p class="image-alt">Enterprise apps clinging to whatever innovation they can get</p><p></p>
<p><strong>There’s a lot to unpack</strong> from last week’s Angular 12 release, the biggest being the framework’s new “Ivy-everywhere” approach — a phrase which conjures some unpleasant (and very itchy) memories of hikes at Boy Scout camp that went terribly wrong.</p>
<p><strong>Wtf is Ivy?</strong> It’s Angular’s default rendering &amp; compilation pipeline that has <a href="https://blog.angular.io/upcoming-improvements-to-angular-library-distribution-76c02f782aa4">slowly been replacing View Engine</a> (the legacy pipeline) over the last year.</p>
<p>Ivy has better code completions, error reporting, hints, and notifications inside Angular templates. Deprecating View Engine should make Angular simpler, faster, and easier to use &amp; maintain.</p>
<p><strong>What else is new in v12:</strong></p>
<ul>
<li>
<p><strong>RIP Protractor</strong> — The Angular team “has been working with the community to determine the future of Protractor.” AKA we’re sick of working on it and hope someone in the community will take it over.</p>
</li>
<li>
<p><strong>RIP IE 11</strong> — Angular 12 joins the other cool kids like <a href="https://github.com/vuejs/rfcs/discussions/296">Vue 3</a> who are deprecating support for IE 11. v12 will include IE11 deprecation warnings and v13 will officially remove support.</p>
</li>
<li>
<p><strong>Nullish Coalescing support</strong> — You can now use JavaScript’s “Nullish Coalescing” (<code>??</code>) feature inside Angular templates.</p>
</li>
</ul>
<p>There’s also new Webpack 5 support, inline Sass, and inline critical CSS.</p>
<h3>The Bottom Line</h3>
<p>It’s easy for <del>us</del> some people to make jokes about Angular being the JavaScript framework with the strongest Boomer energy.</p>
<p>But then they come out with this big v12 release, they brag about their npm downloads growing from 1.6m in 2019 to 2.4m in 2020, RxJS releases a big update, and it seems like Angular’s back on the come-up.</p>
<hr>
<h2>Cool Bits</h2>
<ol>
<li>
<p>Babel wrote about how <strong><a href="https://babeljs.io/blog/2021/05/10/funding-update.html">it’s running out of money</a></strong>. Naturally the reactions to this were only positive since we’re a kind, supportive, and appreciative community <span role="img" aria-label="smiling face with tear">🥲</span>.</p>
</li>
<li>
<p>Stephanie Eckles wrote <strong><a href="https://www.smashingmagazine.com/2021/05/complete-guide-css-container-queries/">a primer on CSS Container Queries</a></strong> that will help you feel smarter than your co-workers since this is a new, experimental feature.</p>
</li>
<li>
<p><strong><a href="https://workspaceupdates.googleblog.com/2021/05/Google-Docs-Canvas-Based-Rendering-Update.html">Google Docs is switching</a></strong> from HTML-based rendering to Canvas-based rendering, but they aren’t the first ones <a href="https://engineering.flipboard.com/2015/02/mobile-web">to do so</a>.</p>
</li>
<li>
<p>In this article, <a href="https://twitter.com/benmvp/status/1315524428596355072">Ben Illegbodu</a> shows you how to lower your reliance on Lodash with <strong><a href="https://www.benmvp.com/blog/9-single-statement-javascript-algorithms-common-data-transformations/">9 single-statement JS algorithms for common data transformations</a></strong>.</p>
</li>
<li>
<p><strong><a href="https://deno.com/blog/v1.10">Deno 1.1 was released</a></strong>. Ah, that explains why why nobody was talking about the Babel situation at all last week — everyone was too busy trying out Deno’s new built-in test runner.</p>
</li>
<li>
<p><strong><a href="https://prettier.io/blog/2021/05/09/2.3.0.html">Prettier 2.3</a></strong> came out last week, and it fixes some longstanding issues with the JavaScript printer. JavaScript Pam Beasley is very pleased.</p>
</li>
<li>
<p>Piero made a <strong><a href="https://aaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.com/">URL lengthener</a></strong>, which is a concept that’s almost as cursed as most of Elon Musk’s SNL sketches.</p>
</li>
<li>
<p>Sandro wrote a great guide called <strong><a href="https://turriate.com/articles/modern-javascript-everything-you-missed-over-10-years">Modern JavaScript: Everything you’ve missed over the last 10 years</a></strong>. It’s the perfect resource if you learned JavaScript in 2011, but then gave it all up to pursue your dream of becoming a classically trained French pastry chef, only to discover years later that the cutthroat Pâtisserie world had left you feeling jaded and alone, and so you just decided last week to get back into web development, but really wished there was a concise guide that could help fill in all the gaps of what you’d missed in JavaScript over the last decade while you were busy perfecting your <em>pâte à choux</em> technique. It’s also a good article if you’re just curious what’s changed in JavaScript over the last 10 years.</p>
</li>
</ol>
<hr>
<h2>A (probably too long for this Newsletter) Introduction to Recoil</h2>
<p>Created from a team at Facebook, Recoil is an “experimental set of utilities for state management in React”.</p>
<blockquote>
<p>It should be noted that even though Recoil was created by a team at Facebook (as with React), it’s not <a href="https://twitter.com/dan_abramov/status/1262143522959998977">“in any way, an ‘official’ state management library for React”</a> <span role="img" aria-label="upside-down face">🙃</span></p>
</blockquote>
<p>Per usual, before we dive into the code let’s look at why Recoil was created and what problems it attempts to solve.</p>
<p>There’s an internal tool at Facebook called “Comparison View”. It’s a “data analysis app for performance data”. That’s a fancy way of saying it’s an app that lets you analyze performance data across Facebook. As you can imagine, it’s rather complex. What they found was that for their use cases, both React component state and Redux didn’t work well. They kept hitting performance and flexibility limits. I think it’s safe to assume this wasn’t just a “they don’t know what they’re doing” thing.</p>
<p>Recoil was created to solve these problems. Specifically, flexible shared state and derived data and queries.</p>
<h3>Flexible shared state</h3>
<p>Performant, synchronized, shared state across any React component that needs it in your component tree.</p>
<h3>Derived data and queries</h3>
<p>The ability to (re)compute values (performantly and efficiently) whenever any of the state in your application changes.</p>
<hr>
<p>What I like about Recoil is its simplicity. Whenever I’d work with Redux, the mental model always felt completely different than React’s. Almost like there was context switching costs moving between “React code” and “Redux code”. With Recoil, though not completely aligned, it’s much closer.</p>
<blockquote>
<p>We’re going to build the most pointless app to demonstrate the benefits of a state management library, a counter app. However, it’s a nice warmup to the syntax.</p>
</blockquote>
<h3>atoms</h3>
<p>atoms are changeable, subscribable, units of state. Any React component that subscribes to an atom will receive the new, updated value whenever the atom changes. Whenever an atom changes, only the React components that subscribe to that atom will be updated.</p>
<p>You create a new atom by invoking <code>atom</code> (which you can get as a named import on the <code>recoil</code> package), passing it an object with a unique <code>key</code> property and its <code>default</code> value.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> atom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'recoil'</span>

<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">atom</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'countState'</span><span class="token punctuation">,</span>
  <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Now, any component that needs access to the <code>count</code>’s state can subscribe to it and update it. To do that, you use the <code>useRecoilState</code> Hook. It has the same API as <code>React.useState</code> except instead of passing it a default value, you pass it the atom.</p>
<pre><code class="language-jsx">import React from 'react'
import { atom, useRecoilState } from 'recoil'

const countState = atom({
  key: 'countState',
  default: 0
})

function Counter() {
  const [count, setCount] = useRecoilState(countState)

  const increment = () =&gt;
    setCount((count) =&gt; count + 1)

  const decrement = () =&gt;
    setCount((count) =&gt; count - 1)

  return (
    &lt;React.Fragment&gt;
      &lt;button onClick={decrement}&gt;-&lt;/button&gt;
      &lt;h1&gt;{count}&lt;/h1&gt;
      &lt;button onClick={increment}&gt;+&lt;/button&gt;
    &lt;/React.Fragment&gt;
  )
}
</code></pre>
<p>Like most React libraries, we need to wrap our app with a provider component so Recoil can use context to pass state anywhere in our component tree. For Recoil, this provider component is named <code>RecoilRoot</code>.</p>
<pre><code class="language-jsx">import React from 'react'
import {
  RecoilRoot,
  atom,
  useRecoilState
} from 'recoil'

const countAtom = atom({
  key: 'countState',
  default: 0
})

function Counter() {
  const [count, setCount] = useRecoilState(countAtom)

  const increment = () =&gt;
    setCount((count) =&gt; count + 1)

  const decrement = () =&gt;
    setCount((count) =&gt; count - 1)

  return (
    &lt;React.Fragment&gt;
      &lt;button onClick={decrement}&gt;-&lt;/button&gt;
      &lt;h1&gt;{count}&lt;/h1&gt;
      &lt;button onClick={increment}&gt;+&lt;/button&gt;
    &lt;/React.Fragment&gt;
  )
}

export default function App () {
  return (
    &lt;RecoilRoot&gt;
      &lt;Counter /&gt;
    &lt;/RecoilRoot&gt;
  )
}
</code></pre>
<p><strong><a href="https://codesandbox.io/s/count-h7eyh"><span role="img" aria-label="laptop">💻</span> Play with the code.</a></strong></p>
<p>At this point we know the syntax for the absolute basics of Recoil – creating an atom and then subscribing and updating it from inside of a component.</p>
<p>If you’ll remember back to the goals of Recoil, they were “flexible shared state and derived data and queries.” We now know how to add “flexible shared state” to our application using <code>atom</code>s. Next we need to figure out “derived data and queries”.</p>
<h3>selectors</h3>
<p>One of the core foundations of functional programming is the concept of pure functions. Pure functions maximize the predictability of your program. A function is “pure” if it meets the following criteria:</p>
<ol>
<li>Always return the same result given the same arguments.</li>
<li>Its execution doesn’t depend on the state of the application.</li>
<li>Doesn’t modify the variables outside of its own scope.</li>
</ol>
<p>When you call a function that is “pure”, you can predict exactly what’s going to happen based on its input.</p>
<p>The way Recoil solves “derived data and queries” is by leveraging pure functions which can derive a new value from existing atoms’ state. The term for how they do this is called a “selector”.</p>
<blockquote>
<p>“A selector represents a piece of derived state. You can think of derived state as the output of passing state to a pure function that modifies the given state in some way.”</p>
</blockquote>
<p>Again, to get a soft introduction to the syntax, we’ll use a contrived example. Let’s say we wanted to, using our previous <code>count</code> state, derive whatever <code>count * 2</code> is. We can do so by creating a <code>double</code> selector.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> selector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'recoil'</span>

<span class="token keyword">const</span> double <span class="token operator">=</span> <span class="token function">selector</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'double'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> get <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>countAtom<span class="token punctuation">)</span>

    <span class="token keyword">return</span> count <span class="token operator">*</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Notice that we pass <code>selector</code> an object with two properties, a unique <code>key</code> and a <code>get</code> method. <code>get</code> is a function that recoil will invoke passing it an object that has another <code>get</code> method on it. This <code>get</code> method allows you to get access to an atom’s (or another selector’s) piece of state. We can then take that state (in our case, <code>count</code>), and derive a new value from it.</p>
<p>Instead of using the <code>useRecoilState</code> Hook (which gives you both the value and a way to update the value), since selectors are derived values only, you use the <code>useRecoilValue</code> Hook instead.</p>
<pre><code class="language-jsx">import React from 'react'
import {
  RecoilRoot,
  atom,
  useRecoilState,
  selector,
  useRecoilValue
} from 'recoil'

const countAtom = atom({
  key: 'countState',
  default: 0
})

const double = selector({
  key: 'double',
  get: ({ get }) =&gt; {
    const count = get(countAtom)

    return count * 2
  }
})

function Counter() {
  const [count, setCount] = useRecoilState(countAtom)
  const doubled = useRecoilValue(double)

  const increment = () =&gt;
    setCount((count) =&gt; count + 1)

  const decrement = () =&gt;
    setCount((count) =&gt; count - 1)

  return (
    &lt;RecoilRoot&gt;
      &lt;button onClick={decrement}&gt;-&lt;/button&gt;
      &lt;h1&gt;{count} - {doubled}&lt;/h1&gt;
      &lt;button onClick={increment}&gt;+&lt;/button&gt;
    &lt;/RecoilRoot&gt;
  )
}

export default function App () {
  return (
    &lt;RecoilRoot&gt;
      &lt;Counter /&gt;
    &lt;/RecoilRoot&gt;
  )
}
</code></pre>
<p><strong><a href="https://codesandbox.io/s/count-selector-wi0vx"><span role="img" aria-label="laptop">💻</span> Play with the code.</a></strong></p>
<p>What I love about selectors is you get rid of the ceremony around syncing state. Instead, you can, in a very predictable manner, abstract that complexity to its own selector. Even better, the selector will only recompute whenever one of the values it depends on changes. This also means that any React components that depend on a particular selector will only re-render if one of the values the selector depends on changes as well.</p>
<h3>Async State</h3>
<p>Our counter example has proven effective in giving us a solid understanding of the Recoil syntax, however, it comes up short when it comes to practicality.</p>
<p>One fundamental aspect of building any application is the ability to fetch asynchronous data. Here’s another thing that’s rad about selectors –&nbsp;they can be asynchronous. The mental model still works the same. Instead of deriving values locally, you have the ability to derive values asynchronously from a server. Under the hood, Recoil still models this as a pure function. If the selector has the same inputs, it will always give you the same outputs (by utilizing cache).</p>
<p>To do this, you just return a <code>Promise</code> from the selectors <code>get</code> method which resolves with the value.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> atom<span class="token punctuation">,</span> selector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'recoil'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> language <span class="token operator">=</span> <span class="token function">atom</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'language'</span><span class="token punctuation">,</span>
  <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'javascript'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> reposQuery <span class="token operator">=</span> <span class="token function">selector</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'reposQuery'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> get <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> repos <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getRepos</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>language<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> repos
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>No <code>thunks</code>, no <code>sagas</code>, you just create async selectors then use them whenever you want using <code>useRecoilValue</code>.</p>
<hr>
<h2>Should you use Recoil?</h2>
<p>Naturally, it depends. Here’s the mental checklist I’ll go through from now on when deciding between component state, context, Redux, and Recoil.</p>
<ol>
<li>Do I need shared state? If no, use component state. If yes, continue.</li>
<li>Can I move the shared state up to the closest parent component without creating performance or prop drilling issues? If yes, do that. If no, continue.</li>
<li>Is my shared state simple and predictable enough where I can put it on context? If yes, do that. If no, continue.</li>
<li>Use Recoil.</li>
</ol>
<p>What I never liked about Redux is it felt like it was all or nothing, Redux vs React. There’s so much ceremony in setting up the store, actions, reducers, etc. that by the time you were done, you might as well just put everything in Redux regardless of best practices. With Recoil, it’s the opposite. You can simply abstract shared state amongst different atoms/selectors and then sprinkle them in while your React code stays almost exactly the same.</p>
<p>As someone who has always been a Redux sympathizer (“it’s great if you use it for the right problem” was my mantra), I didn’t expect to love Recoil as much as I do. I also didn’t expect to throw out Redux completely, but here we are.</p></div></body></html></div></div><aside class="sticky top-20 self-start justify-self-center hidden xl:block mt-80"><div class="grid gap-4 max-w-xs"><div><p class="mb-6 text-center text-xl">Subscribe to join<!-- --> <span class="font-black">212,299</span> <!-- -->developers who receive Bytes each week, for free.</p><input class="rounded-tl rounded-tr font-medium appearance-none rounded-none float-left text-base mt-0 p-2 w-full h-11 border-none placeholder-biege/50 bg-charcoal focus:outline-none focus:ring-2 focus:ring-blue focus:border-transparent" type="email" autoComplete="email" placeholder="email address"/><button class="w-full text-black rounded-br rounded-bl text-sm md:text-lg font-black bg-yellow rounded-none float-left h-10 shadow-none uppercase disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-blue focus:border-transparent active:bg-yellow-600">Subscribe</button></div></div></aside></div></div><footer class="mt-20 py-8 lg:pt-20 lg:pb-10 relative bg-brand-charcoal text-brand-biege"><div class="container mx-auto px-8 mb-12 flex justify-center"><img src="/images/bytes-icon.png" alt="Bytes" width="48"/></div><div class="container mx-auto px-8 pb-8"><div><ul class="list-unstyled flex justify-center flex-wrap gap-4 text-sm"><li><a class="underline" href="/archives">Archives</a></li><li><a class="underline" href="/advertise">Advertise</a></li><li><a class="underline" target="_blank" rel="noopener noreferrer" href="https://npmtrends.com">npmtrends</a></li><li><a class="underline" target="_blank" rel="noopener noreferrer" href="https://react.gg">Learn React</a></li><li><a class="underline" target="_blank" rel="noopener noreferrer" href="https://query.gg">Learn React Query</a></li><li><a class="underline" target="_blank" rel="noopener noreferrer" href="https://usehooks.com">useHooks</a></li></ul></div></div><p class="text-center mb-8">Made with ❤️ by<!-- --> <a class="text-brand-red underline" href="https://ui.dev">uidotdev</a></p></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"subcount":212299,"post":{"data":{"title":"Bytes: the cutthroat Pâtisserie world","date":"2021-05-17","description":"This issue, we've got some Angular Ivy, Recoil, and cursed Elon Musk SNL sketches","featuredImage":"https://bytes.dev/images/content/ivy.png"},"content":"\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003cdiv style=\"max-width:600px;padding-top:80px\"\u003e\u003cdiv style=\"text-align:center\"\u003e\u003cimg width=\"600\" style=\"padding-bottom:40px;max-width:100%\" src=\"https://bytes.dev/images/bytes-banner-rounded.png\" alt=\"Bytes\"\u003e\u003c/div\u003e\u003ch2\u003eAngular 12 goes all-in on Ivy\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"https://bytes.dev/images/content/ivy.png\" alt=\"Ivy\"\u003e\n\u003c/p\u003e\u003cp class=\"image-alt\"\u003eEnterprise apps clinging to whatever innovation they can get\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eThere’s a lot to unpack\u003c/strong\u003e from last week’s Angular 12 release, the biggest being the framework’s new “Ivy-everywhere” approach — a phrase which conjures some unpleasant (and very itchy) memories of hikes at Boy Scout camp that went terribly wrong.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWtf is Ivy?\u003c/strong\u003e It’s Angular’s default rendering \u0026amp; compilation pipeline that has \u003ca href=\"https://blog.angular.io/upcoming-improvements-to-angular-library-distribution-76c02f782aa4\"\u003eslowly been replacing View Engine\u003c/a\u003e (the legacy pipeline) over the last year.\u003c/p\u003e\n\u003cp\u003eIvy has better code completions, error reporting, hints, and notifications inside Angular templates. Deprecating View Engine should make Angular simpler, faster, and easier to use \u0026amp; maintain.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWhat else is new in v12:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRIP Protractor\u003c/strong\u003e — The Angular team “has been working with the community to determine the future of Protractor.” AKA we’re sick of working on it and hope someone in the community will take it over.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRIP IE 11\u003c/strong\u003e — Angular 12 joins the other cool kids like \u003ca href=\"https://github.com/vuejs/rfcs/discussions/296\"\u003eVue 3\u003c/a\u003e who are deprecating support for IE 11. v12 will include IE11 deprecation warnings and v13 will officially remove support.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eNullish Coalescing support\u003c/strong\u003e — You can now use JavaScript’s “Nullish Coalescing” (\u003ccode\u003e??\u003c/code\u003e) feature inside Angular templates.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThere’s also new Webpack 5 support, inline Sass, and inline critical CSS.\u003c/p\u003e\n\u003ch3\u003eThe Bottom Line\u003c/h3\u003e\n\u003cp\u003eIt’s easy for \u003cdel\u003eus\u003c/del\u003e some people to make jokes about Angular being the JavaScript framework with the strongest Boomer energy.\u003c/p\u003e\n\u003cp\u003eBut then they come out with this big v12 release, they brag about their npm downloads growing from 1.6m in 2019 to 2.4m in 2020, RxJS releases a big update, and it seems like Angular’s back on the come-up.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eCool Bits\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eBabel wrote about how \u003cstrong\u003e\u003ca href=\"https://babeljs.io/blog/2021/05/10/funding-update.html\"\u003eit’s running out of money\u003c/a\u003e\u003c/strong\u003e. Naturally the reactions to this were only positive since we’re a kind, supportive, and appreciative community \u003cspan role=\"img\" aria-label=\"smiling face with tear\"\u003e🥲\u003c/span\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eStephanie Eckles wrote \u003cstrong\u003e\u003ca href=\"https://www.smashingmagazine.com/2021/05/complete-guide-css-container-queries/\"\u003ea primer on CSS Container Queries\u003c/a\u003e\u003c/strong\u003e that will help you feel smarter than your co-workers since this is a new, experimental feature.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://workspaceupdates.googleblog.com/2021/05/Google-Docs-Canvas-Based-Rendering-Update.html\"\u003eGoogle Docs is switching\u003c/a\u003e\u003c/strong\u003e from HTML-based rendering to Canvas-based rendering, but they aren’t the first ones \u003ca href=\"https://engineering.flipboard.com/2015/02/mobile-web\"\u003eto do so\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn this article, \u003ca href=\"https://twitter.com/benmvp/status/1315524428596355072\"\u003eBen Illegbodu\u003c/a\u003e shows you how to lower your reliance on Lodash with \u003cstrong\u003e\u003ca href=\"https://www.benmvp.com/blog/9-single-statement-javascript-algorithms-common-data-transformations/\"\u003e9 single-statement JS algorithms for common data transformations\u003c/a\u003e\u003c/strong\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://deno.com/blog/v1.10\"\u003eDeno 1.1 was released\u003c/a\u003e\u003c/strong\u003e. Ah, that explains why why nobody was talking about the Babel situation at all last week — everyone was too busy trying out Deno’s new built-in test runner.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://prettier.io/blog/2021/05/09/2.3.0.html\"\u003ePrettier 2.3\u003c/a\u003e\u003c/strong\u003e came out last week, and it fixes some longstanding issues with the JavaScript printer. JavaScript Pam Beasley is very pleased.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePiero made a \u003cstrong\u003e\u003ca href=\"https://aaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.com/\"\u003eURL lengthener\u003c/a\u003e\u003c/strong\u003e, which is a concept that’s almost as cursed as most of Elon Musk’s SNL sketches.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSandro wrote a great guide called \u003cstrong\u003e\u003ca href=\"https://turriate.com/articles/modern-javascript-everything-you-missed-over-10-years\"\u003eModern JavaScript: Everything you’ve missed over the last 10 years\u003c/a\u003e\u003c/strong\u003e. It’s the perfect resource if you learned JavaScript in 2011, but then gave it all up to pursue your dream of becoming a classically trained French pastry chef, only to discover years later that the cutthroat Pâtisserie world had left you feeling jaded and alone, and so you just decided last week to get back into web development, but really wished there was a concise guide that could help fill in all the gaps of what you’d missed in JavaScript over the last decade while you were busy perfecting your \u003cem\u003epâte à choux\u003c/em\u003e technique. It’s also a good article if you’re just curious what’s changed in JavaScript over the last 10 years.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch2\u003eA (probably too long for this Newsletter) Introduction to Recoil\u003c/h2\u003e\n\u003cp\u003eCreated from a team at Facebook, Recoil is an “experimental set of utilities for state management in React”.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIt should be noted that even though Recoil was created by a team at Facebook (as with React), it’s not \u003ca href=\"https://twitter.com/dan_abramov/status/1262143522959998977\"\u003e“in any way, an ‘official’ state management library for React”\u003c/a\u003e \u003cspan role=\"img\" aria-label=\"upside-down face\"\u003e🙃\u003c/span\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003ePer usual, before we dive into the code let’s look at why Recoil was created and what problems it attempts to solve.\u003c/p\u003e\n\u003cp\u003eThere’s an internal tool at Facebook called “Comparison View”. It’s a “data analysis app for performance data”. That’s a fancy way of saying it’s an app that lets you analyze performance data across Facebook. As you can imagine, it’s rather complex. What they found was that for their use cases, both React component state and Redux didn’t work well. They kept hitting performance and flexibility limits. I think it’s safe to assume this wasn’t just a “they don’t know what they’re doing” thing.\u003c/p\u003e\n\u003cp\u003eRecoil was created to solve these problems. Specifically, flexible shared state and derived data and queries.\u003c/p\u003e\n\u003ch3\u003eFlexible shared state\u003c/h3\u003e\n\u003cp\u003ePerformant, synchronized, shared state across any React component that needs it in your component tree.\u003c/p\u003e\n\u003ch3\u003eDerived data and queries\u003c/h3\u003e\n\u003cp\u003eThe ability to (re)compute values (performantly and efficiently) whenever any of the state in your application changes.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eWhat I like about Recoil is its simplicity. Whenever I’d work with Redux, the mental model always felt completely different than React’s. Almost like there was context switching costs moving between “React code” and “Redux code”. With Recoil, though not completely aligned, it’s much closer.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWe’re going to build the most pointless app to demonstrate the benefits of a state management library, a counter app. However, it’s a nice warmup to the syntax.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003eatoms\u003c/h3\u003e\n\u003cp\u003eatoms are changeable, subscribable, units of state. Any React component that subscribes to an atom will receive the new, updated value whenever the atom changes. Whenever an atom changes, only the React components that subscribe to that atom will be updated.\u003c/p\u003e\n\u003cp\u003eYou create a new atom by invoking \u003ccode\u003eatom\u003c/code\u003e (which you can get as a named import on the \u003ccode\u003erecoil\u003c/code\u003e package), passing it an object with a unique \u003ccode\u003ekey\u003c/code\u003e property and its \u003ccode\u003edefault\u003c/code\u003e value.\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e atom \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'recoil'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e count \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eatom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ekey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'countState'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003edefault\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, any component that needs access to the \u003ccode\u003ecount\u003c/code\u003e’s state can subscribe to it and update it. To do that, you use the \u003ccode\u003euseRecoilState\u003c/code\u003e Hook. It has the same API as \u003ccode\u003eReact.useState\u003c/code\u003e except instead of passing it a default value, you pass it the atom.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-jsx\"\u003eimport React from 'react'\nimport { atom, useRecoilState } from 'recoil'\n\nconst countState = atom({\n  key: 'countState',\n  default: 0\n})\n\nfunction Counter() {\n  const [count, setCount] = useRecoilState(countState)\n\n  const increment = () =\u0026gt;\n    setCount((count) =\u0026gt; count + 1)\n\n  const decrement = () =\u0026gt;\n    setCount((count) =\u0026gt; count - 1)\n\n  return (\n    \u0026lt;React.Fragment\u0026gt;\n      \u0026lt;button onClick={decrement}\u0026gt;-\u0026lt;/button\u0026gt;\n      \u0026lt;h1\u0026gt;{count}\u0026lt;/h1\u0026gt;\n      \u0026lt;button onClick={increment}\u0026gt;+\u0026lt;/button\u0026gt;\n    \u0026lt;/React.Fragment\u0026gt;\n  )\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLike most React libraries, we need to wrap our app with a provider component so Recoil can use context to pass state anywhere in our component tree. For Recoil, this provider component is named \u003ccode\u003eRecoilRoot\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-jsx\"\u003eimport React from 'react'\nimport {\n  RecoilRoot,\n  atom,\n  useRecoilState\n} from 'recoil'\n\nconst countAtom = atom({\n  key: 'countState',\n  default: 0\n})\n\nfunction Counter() {\n  const [count, setCount] = useRecoilState(countAtom)\n\n  const increment = () =\u0026gt;\n    setCount((count) =\u0026gt; count + 1)\n\n  const decrement = () =\u0026gt;\n    setCount((count) =\u0026gt; count - 1)\n\n  return (\n    \u0026lt;React.Fragment\u0026gt;\n      \u0026lt;button onClick={decrement}\u0026gt;-\u0026lt;/button\u0026gt;\n      \u0026lt;h1\u0026gt;{count}\u0026lt;/h1\u0026gt;\n      \u0026lt;button onClick={increment}\u0026gt;+\u0026lt;/button\u0026gt;\n    \u0026lt;/React.Fragment\u0026gt;\n  )\n}\n\nexport default function App () {\n  return (\n    \u0026lt;RecoilRoot\u0026gt;\n      \u0026lt;Counter /\u0026gt;\n    \u0026lt;/RecoilRoot\u0026gt;\n  )\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://codesandbox.io/s/count-h7eyh\"\u003e\u003cspan role=\"img\" aria-label=\"laptop\"\u003e💻\u003c/span\u003e Play with the code.\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eAt this point we know the syntax for the absolute basics of Recoil – creating an atom and then subscribing and updating it from inside of a component.\u003c/p\u003e\n\u003cp\u003eIf you’ll remember back to the goals of Recoil, they were “flexible shared state and derived data and queries.” We now know how to add “flexible shared state” to our application using \u003ccode\u003eatom\u003c/code\u003es. Next we need to figure out “derived data and queries”.\u003c/p\u003e\n\u003ch3\u003eselectors\u003c/h3\u003e\n\u003cp\u003eOne of the core foundations of functional programming is the concept of pure functions. Pure functions maximize the predictability of your program. A function is “pure” if it meets the following criteria:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eAlways return the same result given the same arguments.\u003c/li\u003e\n\u003cli\u003eIts execution doesn’t depend on the state of the application.\u003c/li\u003e\n\u003cli\u003eDoesn’t modify the variables outside of its own scope.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eWhen you call a function that is “pure”, you can predict exactly what’s going to happen based on its input.\u003c/p\u003e\n\u003cp\u003eThe way Recoil solves “derived data and queries” is by leveraging pure functions which can derive a new value from existing atoms’ state. The term for how they do this is called a “selector”.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e“A selector represents a piece of derived state. You can think of derived state as the output of passing state to a pure function that modifies the given state in some way.”\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAgain, to get a soft introduction to the syntax, we’ll use a contrived example. Let’s say we wanted to, using our previous \u003ccode\u003ecount\u003c/code\u003e state, derive whatever \u003ccode\u003ecount * 2\u003c/code\u003e is. We can do so by creating a \u003ccode\u003edouble\u003c/code\u003e selector.\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e selector \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'recoil'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e double \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eselector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ekey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'double'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token function-variable function\"\u003eget\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e get \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e count \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecountAtom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e count \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNotice that we pass \u003ccode\u003eselector\u003c/code\u003e an object with two properties, a unique \u003ccode\u003ekey\u003c/code\u003e and a \u003ccode\u003eget\u003c/code\u003e method. \u003ccode\u003eget\u003c/code\u003e is a function that recoil will invoke passing it an object that has another \u003ccode\u003eget\u003c/code\u003e method on it. This \u003ccode\u003eget\u003c/code\u003e method allows you to get access to an atom’s (or another selector’s) piece of state. We can then take that state (in our case, \u003ccode\u003ecount\u003c/code\u003e), and derive a new value from it.\u003c/p\u003e\n\u003cp\u003eInstead of using the \u003ccode\u003euseRecoilState\u003c/code\u003e Hook (which gives you both the value and a way to update the value), since selectors are derived values only, you use the \u003ccode\u003euseRecoilValue\u003c/code\u003e Hook instead.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-jsx\"\u003eimport React from 'react'\nimport {\n  RecoilRoot,\n  atom,\n  useRecoilState,\n  selector,\n  useRecoilValue\n} from 'recoil'\n\nconst countAtom = atom({\n  key: 'countState',\n  default: 0\n})\n\nconst double = selector({\n  key: 'double',\n  get: ({ get }) =\u0026gt; {\n    const count = get(countAtom)\n\n    return count * 2\n  }\n})\n\nfunction Counter() {\n  const [count, setCount] = useRecoilState(countAtom)\n  const doubled = useRecoilValue(double)\n\n  const increment = () =\u0026gt;\n    setCount((count) =\u0026gt; count + 1)\n\n  const decrement = () =\u0026gt;\n    setCount((count) =\u0026gt; count - 1)\n\n  return (\n    \u0026lt;RecoilRoot\u0026gt;\n      \u0026lt;button onClick={decrement}\u0026gt;-\u0026lt;/button\u0026gt;\n      \u0026lt;h1\u0026gt;{count} - {doubled}\u0026lt;/h1\u0026gt;\n      \u0026lt;button onClick={increment}\u0026gt;+\u0026lt;/button\u0026gt;\n    \u0026lt;/RecoilRoot\u0026gt;\n  )\n}\n\nexport default function App () {\n  return (\n    \u0026lt;RecoilRoot\u0026gt;\n      \u0026lt;Counter /\u0026gt;\n    \u0026lt;/RecoilRoot\u0026gt;\n  )\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://codesandbox.io/s/count-selector-wi0vx\"\u003e\u003cspan role=\"img\" aria-label=\"laptop\"\u003e💻\u003c/span\u003e Play with the code.\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eWhat I love about selectors is you get rid of the ceremony around syncing state. Instead, you can, in a very predictable manner, abstract that complexity to its own selector. Even better, the selector will only recompute whenever one of the values it depends on changes. This also means that any React components that depend on a particular selector will only re-render if one of the values the selector depends on changes as well.\u003c/p\u003e\n\u003ch3\u003eAsync State\u003c/h3\u003e\n\u003cp\u003eOur counter example has proven effective in giving us a solid understanding of the Recoil syntax, however, it comes up short when it comes to practicality.\u003c/p\u003e\n\u003cp\u003eOne fundamental aspect of building any application is the ability to fetch asynchronous data. Here’s another thing that’s rad about selectors –\u0026nbsp;they can be asynchronous. The mental model still works the same. Instead of deriving values locally, you have the ability to derive values asynchronously from a server. Under the hood, Recoil still models this as a pure function. If the selector has the same inputs, it will always give you the same outputs (by utilizing cache).\u003c/p\u003e\n\u003cp\u003eTo do this, you just return a \u003ccode\u003ePromise\u003c/code\u003e from the selectors \u003ccode\u003eget\u003c/code\u003e method which resolves with the value.\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e atom\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e selector \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'recoil'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e language \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eatom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ekey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'language'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003edefault\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'javascript'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e reposQuery \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eselector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ekey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'reposQuery'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token function-variable function\"\u003eget\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e get \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e repos \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003egetRepos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elanguage\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e repos\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNo \u003ccode\u003ethunks\u003c/code\u003e, no \u003ccode\u003esagas\u003c/code\u003e, you just create async selectors then use them whenever you want using \u003ccode\u003euseRecoilValue\u003c/code\u003e.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eShould you use Recoil?\u003c/h2\u003e\n\u003cp\u003eNaturally, it depends. Here’s the mental checklist I’ll go through from now on when deciding between component state, context, Redux, and Recoil.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eDo I need shared state? If no, use component state. If yes, continue.\u003c/li\u003e\n\u003cli\u003eCan I move the shared state up to the closest parent component without creating performance or prop drilling issues? If yes, do that. If no, continue.\u003c/li\u003e\n\u003cli\u003eIs my shared state simple and predictable enough where I can put it on context? If yes, do that. If no, continue.\u003c/li\u003e\n\u003cli\u003eUse Recoil.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eWhat I never liked about Redux is it felt like it was all or nothing, Redux vs React. There’s so much ceremony in setting up the store, actions, reducers, etc. that by the time you were done, you might as well just put everything in Redux regardless of best practices. With Recoil, it’s the opposite. You can simply abstract shared state amongst different atoms/selectors and then sprinkle them in while your React code stays almost exactly the same.\u003c/p\u003e\n\u003cp\u003eAs someone who has always been a Redux sympathizer (“it’s great if you use it for the right problem” was my mantra), I didn’t expect to love Recoil as much as I do. I also didn’t expect to throw out Redux completely, but here we are.\u003c/p\u003e\u003c/div\u003e\u003c/body\u003e\u003c/html\u003e","slug":"48"}},"__N_SSG":true},"page":"/archives/[slug]","query":{"slug":"48"},"buildId":"dY9LIRQQ58VhV_MFEhYS7","runtimeConfig":{"nextPlausiblePublicProxyOptions":{"trailingSlash":false}},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>